<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crypto Position Size Calculator</title>
    <style>
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            margin: 0;
            padding: 15px;
        }

        .calculator-card {
            background: white;
            width: 100%;
            max-width: 375px; /* iPhone size width */
            border-radius: 35px;
            padding: 25px 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            margin: auto;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .header-icon {
            width: 70px;
            height: 70px;
            background: #2D2D3A;
            border-radius: 15px;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4CAF50;
            font-size: 35px;
        }

        .header h2 {
            color: #1a5c3a;
            font-size: 16px;
            margin: 0;
            font-weight: 600;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 15px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .label-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 13px;
            color: #888;
            padding: 0 2px;
        }

        input {
            width: 100%;
            border: 1.5px solid #eee;
            border-radius: 12px;
            padding: 12px;
            font-size: 17px;
            outline: none;
            color: #333;
            transition: border-color 0.2s;
            background: #fff;
        }

        input:focus {
            border-color: #FF6B00;
        }

        .position-size-display {
            text-align: center;
            margin: 15px 0;
        }

        .position-size-display h1 {
            font-size: 45px;
            margin: 0;
            color: #2D2D3A;
            letter-spacing: -1px;
        }

        .position-size-display p {
            color: #4CAF50;
            margin: 2px 0;
            font-weight: 600;
            font-size: 14px;
        }

        .margin-leverage {
            display: flex;
            align-items: flex-end;
            gap: 10px;
            margin-bottom: 20px;
        }

        .arrow-icon {
            font-size: 20px;
            color: #4CAF50;
            padding-bottom: 12px;
        }

        .summary-box {
            background: #2D2D3A;
            border-radius: 18px;
            display: flex;
            overflow: hidden;
            color: white;
            min-height: 90px;
        }

        .summary-left {
            flex: 1.2;
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 1px solid #444;
        }

        .target-input {
            background: rgba(255,255,255,0.05);
            border: 1px solid #666;
            color: white;
            width: 100%;
            text-align: center;
            border-radius: 8px;
            padding: 8px;
            font-size: 15px;
        }

        .summary-right {
            flex: 1;
            padding: 12px 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            font-size: 13px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }

        .val-profit { color: #4CAF50; font-weight: bold; }
        .val-risk { color: #FF5252; font-weight: bold; }
        .val-rr { color: #FFB300; font-weight: bold; }

        .footer-nav {
            background: #FF6B00;
            margin-top: 20px;
            border-radius: 50px;
            display: flex;
            justify-content: space-between;
            padding: 6px;
            color: white;
            align-items: center;
        }

        .nav-item { 
            padding: 8px 12px;
            cursor: pointer; 
            font-size: 14px;
        }
        
        .nav-item.active { 
            background: #1a5c3a; 
            padding: 8px 18px; 
            border-radius: 25px; 
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .nav-icon-set {
            display: flex;
            gap: 15px;
            padding-right: 15px;
        }
    </style>
</head>
<body>

<div class="calculator-card">
    <div class="header">
        <div class="header-icon">üßÆ</div>
        <h2>Crypto Position Size Calculator</h2>
    </div>

    <div class="grid">
        <div class="input-group">
            <div class="label-row"><span>Capital</span></div>
            <input type="number" id="capital" value="130">
        </div>
        <div class="input-group">
            <div class="label-row"><span>Risk %</span> <span id="risk-usd" style="font-size: 11px;">$130</span></div>
            <input type="number" id="risk-pct" value="100">
        </div>
        <div class="input-group">
            <div class="label-row"><span>Entry Price</span></div>
            <input type="number" id="entry" value="95283">
        </div>
        <div class="input-group">
            <div class="label-row"><span>Stop Loss</span></div>
            <input type="number" id="stop" value="94400">
        </div>
    </div>

    <div class="position-size-display">
        <h1 id="pos-size-val">14028</h1>
        <p>Position Size</p>
    </div>

    <div class="margin-leverage">
        <div class="input-group" style="flex: 1;">
            <div class="label-row"><span>Trade Amount</span></div>
            <input type="number" id="trade-amount" value="28.0">
        </div>
        <div class="arrow-icon">‚áÜ</div>
        <div class="input-group" style="flex: 1;">
            <div class="label-row"><span>Leverage</span></div>
            <input type="number" id="leverage" value="45">
        </div>
    </div>

    <div class="summary-box">
        <div class="summary-left">
            <input type="number" id="target-price" class="target-input" value="106200">
        </div>
        <div class="summary-right">
            <div class="summary-item">
                <span>Profit:</span>
                <span class="val-profit" id="res-profit">‚âà1607</span>
            </div>
            <div class="summary-item">
                <span>Risk:</span>
                <span class="val-risk" id="res-risk">130</span>
            </div>
            <div class="summary-item">
                <span>R:R:</span>
                <span class="val-rr" id="res-rr">1:12.36</span>
            </div>
        </div>
    </div>

    <div class="footer-nav">
        <div class="nav-item active">‚Çø Crypto</div>
        <div class="nav-icon-set">
            <div class="nav-item">FX</div>
            <div class="nav-item">üí±</div>
            <div class="nav-item">‚öôÔ∏è</div>
        </div>
    </div>
</div>

<script>
    const ids = ['capital', 'risk-pct', 'entry', 'stop', 'trade-amount', 'leverage', 'target-price'];
    
    ids.forEach(id => {
        document.getElementById(id).addEventListener('input', (e) => calculate(e.target.id));
    });

    function calculate(changedId) {
        const capital = parseFloat(document.getElementById('capital').value) || 0;
        const riskPct = parseFloat(document.getElementById('risk-pct').value) || 0;
        const entry = parseFloat(document.getElementById('entry').value) || 0;
        const stop = parseFloat(document.getElementById('stop').value) || 0;
        const target = parseFloat(document.getElementById('target-price').value) || 0;
        
        let tradeAmount = parseFloat(document.getElementById('trade-amount').value) || 0;
        let leverage = parseFloat(document.getElementById('leverage').value) || 1;

        // Risk USD
        const riskUsd = (capital * riskPct) / 100;
        document.getElementById('risk-usd').innerText = `$${riskUsd.toFixed(0)}`;

        // Position Size
        const stopLossDist = Math.abs(entry - stop) / entry;
        let posSize = 0;
        if (stopLossDist > 0) {
            posSize = riskUsd / stopLossDist;
        }
        document.getElementById('pos-size-val').innerText = Math.round(posSize);

        // Sync Trade Amount & Leverage
        if (changedId === 'trade-amount') {
            leverage = posSize / tradeAmount;
            document.getElementById('leverage').value = isFinite(leverage) ? leverage.toFixed(1) : 0;
        } else if (changedId === 'leverage') {
            tradeAmount = posSize / leverage;
            document.getElementById('trade-amount').value = isFinite(tradeAmount) ? tradeAmount.toFixed(1) : 0;
        } else {
            // Re-calc leverage based on current trade amount if other inputs change
            leverage = posSize / tradeAmount;
            document.getElementById('leverage').value = isFinite(leverage) ? leverage.toFixed(1) : 0;
        }

        // Profit & RR
        const profitDist = Math.abs(target - entry) / entry;
        const profit = posSize * profitDist;
        const rr = (target - entry) / (entry - stop);

        document.getElementById('res-profit').innerText = `‚âà${Math.round(profit)}`;
        document.getElementById('res-risk').innerText = Math.round(riskUsd);
        document.getElementById('res-rr').innerText = `1:${Math.abs(rr).toFixed(2)}`;
    }

    calculate();
</script>

</body>
</html>
